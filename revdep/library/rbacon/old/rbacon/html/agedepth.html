<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Plot an age-depth model</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for agedepth {rbacon}"><tr><td>agedepth {rbacon}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Plot an age-depth model</h2>

<h3>Description</h3>

<p>Plot the age-depth model of a core.
</p>


<h3>Usage</h3>

<pre>
agedepth(
  set = get("info"),
  BCAD = set$BCAD,
  depth.unit = set$depth.unit,
  age.unit = "yr",
  unit = depth.unit,
  d.lab = c(),
  age.lab = c(),
  yr.lab = age.lab,
  kcal = FALSE,
  acc.lab = c(),
  d.min = c(),
  d.max = c(),
  d.by = c(),
  depths = set$depths,
  depths.file = FALSE,
  age.min = c(),
  yr.min = age.min,
  age.max = c(),
  yr.max = age.max,
  hiatus.option = 1,
  dark = c(),
  prob = set$prob,
  rounded = c(),
  d.res = 400,
  age.res = 400,
  yr.res = age.res,
  date.res = 100,
  rotate.axes = FALSE,
  rev.age = FALSE,
  rev.yr = rev.age,
  rev.d = FALSE,
  maxcalc = 500,
  height = 1,
  calheight = 1,
  mirror = TRUE,
  up = TRUE,
  cutoff = 0.1,
  plot.range = TRUE,
  range.col = grey(0.5),
  range.lty = "12",
  mn.col = "red",
  mn.lty = "12",
  med.col = NA,
  med.lty = "12",
  C14.col = rgb(0, 0, 1, 0.35),
  C14.border = rgb(0, 0, 1, 0.5),
  cal.col = rgb(0, 0.5, 0.5, 0.35),
  cal.border = rgb(0, 0.5, 0.5, 0.5),
  dates.col = c(),
  pb.background = 0.5,
  pbmodelled.col = function(x) rgb(0, 0, 1, 0.5 * x),
  pbmeasured.col = "blue",
  pb.lim = c(),
  supp.col = "purple",
  plot.tail = TRUE,
  remove.tail = TRUE,
  hiatus.col = grey(0.5),
  hiatus.lty = "12",
  rgb.scale = c(0, 0, 0),
  rgb.res = 100,
  slump.col = grey(0.8),
  normalise.dists = TRUE,
  same.heights = FALSE,
  cc = set$cc,
  title = set$core,
  title.location = "topleft",
  title.size = 1.5,
  after = set$after,
  bty = "l",
  mar.left = c(3, 3, 1, 1),
  mar.middle = c(3, 0, 1, 0.5),
  mar.right = c(3, 3, 1, 1),
  mar.main = c(3, 3, 1, 1),
  righthand = 3,
  mgp = c(1.7, 0.7, 0),
  xaxs = "r",
  yaxs = "i",
  prior.ticks = "n",
  prior.fontsize = 0.9,
  toppanel.fontsize = 0.9,
  xaxt = "s",
  yaxt = "s",
  plot.pb = TRUE,
  pb.lty = 1,
  plot.pdf = FALSE,
  dates.only = FALSE,
  model.only = FALSE,
  verbose = TRUE
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr valign="top"><td><code>BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>depth.unit</code></td>
<td>
<p>Units of the depths. Defaults to the one provided in the Bacon() command, <code>depth.unit=set$depth.unit</code>.</p>
</td></tr>
<tr valign="top"><td><code>age.unit</code></td>
<td>
<p>Units of the ages. Defaults to <code>age.unit="yr"</code>.</p>
</td></tr>
<tr valign="top"><td><code>unit</code></td>
<td>
<p>Deprecated and replaced by <code>depth.unit</code>.</p>
</td></tr>
<tr valign="top"><td><code>d.lab</code></td>
<td>
<p>The labels for the depth axis. Default <code>d.lab="Depth (cm)"</code>. See also <code>depth.unit</code>.</p>
</td></tr>
<tr valign="top"><td><code>age.lab</code></td>
<td>
<p>The labels for the calendar axis (default <code>age.lab="cal BP"</code> or <code>"BC/AD"</code> if <code>BCAD=TRUE</code>).</p>
</td></tr>
<tr valign="top"><td><code>yr.lab</code></td>
<td>
<p>Deprecated - use age.lab instead</p>
</td></tr>
<tr valign="top"><td><code>kcal</code></td>
<td>
<p>Use kcal BP. Default is <code>kcal=FALSE</code>.</p>
</td></tr>
<tr valign="top"><td><code>acc.lab</code></td>
<td>
<p>The labels for the accumulation rate plot (top middle). Default <code>d.lab="Acc. rate (yr/cm)"</code> (or whatever units you're using).</p>
</td></tr>
<tr valign="top"><td><code>d.min</code></td>
<td>
<p>Minimum depth of age-depth model (use this to extrapolate to depths higher than the top dated depth).</p>
</td></tr>
<tr valign="top"><td><code>d.max</code></td>
<td>
<p>Maximum depth of age-depth model (use this to extrapolate to depths below the bottom dated depth).</p>
</td></tr>
<tr valign="top"><td><code>d.by</code></td>
<td>
<p>Depth intervals at which ages are calculated. Default 1. Alternative depth intervals can be provided using, e.g., d.<code>by=0.5</code>.</p>
</td></tr>
<tr valign="top"><td><code>depths</code></td>
<td>
<p>By default, Bacon will calculate the ages for the depths <code>d.min</code> to <code>d.max</code> in steps of <code>d.by</code>. Alternative depths can be provided as, e.g., <code>depths=seq(0, 100, length=500)</code> or as a file, e.g., <code>depths=read.table("CoreDepths.txt"</code>. See also <code>depths.file</code>.</p>
</td></tr>
<tr valign="top"><td><code>depths.file</code></td>
<td>
<p>By default, Bacon will calculate the ages for the depths <code>d.min</code> to <code>d.max</code> in steps of <code>d.by</code>.
If <code>depths.file=TRUE</code>, Bacon will read a file containing the depths for which you require ages.
This file, containing the depths in a single column without a header, should be stored within <code>coredir</code>,
and its name should start with the core's name and end with '_depths.txt'. Then specify <code>depths.file=TRUE</code> (default <code>FALSE</code>). See also <code>depths</code>.</p>
</td></tr>
<tr valign="top"><td><code>age.min</code></td>
<td>
<p>Minimum age of the age-depth plot.</p>
</td></tr>
<tr valign="top"><td><code>yr.min</code></td>
<td>
<p>Deprecated - use age.min instead.</p>
</td></tr>
<tr valign="top"><td><code>age.max</code></td>
<td>
<p>Maximum age of the age-depth plot.</p>
</td></tr>
<tr valign="top"><td><code>yr.max</code></td>
<td>
<p>Deprecated - use age.min instead.</p>
</td></tr>
<tr valign="top"><td><code>hiatus.option</code></td>
<td>
<p>How to calculate accumulation rates and ages for sections with hiatuses. Either extrapolate from surrounding sections (default, <code>hiatus.option=1</code>), use a w-weighted mix between the prior and posterior values for depths below the hiatus and prior information only for above the hiatus (<code>hiatus.option=2</code>), or use the originally calculated slopes (<code>hiatus.option=0</code>).</p>
</td></tr>
<tr valign="top"><td><code>dark</code></td>
<td>
<p>Darkness of the greyscale age-depth model. By default, the darkest grey value is calculated as 10 times the height of the lowest-precision age estimate <code>dark=c()</code>. Lower values will result in lighter grey but values &gt;1 are not allowed.</p>
</td></tr>
<tr valign="top"><td><code>prob</code></td>
<td>
<p>Confidence interval to report (between 0 and 1, default 0.95 or 95%).</p>
</td></tr>
<tr valign="top"><td><code>rounded</code></td>
<td>
<p>Rounding of years. Default is to round to single years (1 digit for plum models).</p>
</td></tr>
<tr valign="top"><td><code>d.res</code></td>
<td>
<p>Resolution or amount of greyscale pixels to cover the depth scale of the age-model plot. Default <code>d.res=200</code>.</p>
</td></tr>
<tr valign="top"><td><code>age.res</code></td>
<td>
<p>Resolution or amount of greyscale pixels to cover the age scale of the age-model plot. Default <code>yr.res=200</code>.</p>
</td></tr>
<tr valign="top"><td><code>yr.res</code></td>
<td>
<p>Deprecated - use age.res instead.</p>
</td></tr>
<tr valign="top"><td><code>date.res</code></td>
<td>
<p>Date distributions are plotted using <code>date.res=100</code> points by default.</p>
</td></tr>
<tr valign="top"><td><code>rotate.axes</code></td>
<td>
<p>By default, the age-depth model is plotted with the depths on the horizontal axis and ages on the vertical axis. This can be changed with <code>rotate.axes=TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>rev.age</code></td>
<td>
<p>The direction of the age axis, which can be reversed using <code>rev.age=TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>rev.yr</code></td>
<td>
<p>Deprecated - use rev.age instead.</p>
</td></tr>
<tr valign="top"><td><code>rev.d</code></td>
<td>
<p>The direction of the depth axis, which can be reversed using <code>rev.d=TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>maxcalc</code></td>
<td>
<p>Number of depths to calculate ages for. If this is more than <code>maxcalc=500</code>, a warning will be shown that calculations will take time.</p>
</td></tr>
<tr valign="top"><td><code>height</code></td>
<td>
<p>The maximum heights of the distributions of the dates on the plot. See also <code>normalise.dists</code>.</p>
</td></tr>
<tr valign="top"><td><code>calheight</code></td>
<td>
<p>Multiplier for the heights of the distributions of dates on the calendar scale. Defaults to <code>calheight=1</code>.</p>
</td></tr>
<tr valign="top"><td><code>mirror</code></td>
<td>
<p>Plot the dates as 'blobs'. Set to <code>mirror=FALSE</code> to plot simple distributions.</p>
</td></tr>
<tr valign="top"><td><code>up</code></td>
<td>
<p>Directions of distributions if they are plotted non-mirrored. Default <code>up=TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>cutoff</code></td>
<td>
<p>Avoid plotting very low probabilities of date distributions (default <code>cutoff=0.1</code>).</p>
</td></tr>
<tr valign="top"><td><code>plot.range</code></td>
<td>
<p>Whether or not to plot the curves showing the confidence ranges of the age-model. Defaults to (<code>plot.range=TRUE</code>).</p>
</td></tr>
<tr valign="top"><td><code>range.col</code></td>
<td>
<p>The colour of the curves showing the confidence ranges of the age-model. Defaults to medium grey (<code>range.col=grey(0.5)</code>).</p>
</td></tr>
<tr valign="top"><td><code>range.lty</code></td>
<td>
<p>The line type of the curves showing the confidence ranges of the age-model. Defaults to <code>range.lty=12</code>.</p>
</td></tr>
<tr valign="top"><td><code>mn.col</code></td>
<td>
<p>The colour of the mean age-depth model: default <code>mn.col="red"</code>.</p>
</td></tr>
<tr valign="top"><td><code>mn.lty</code></td>
<td>
<p>The line type of the mean age-depth model. Default <code>mn.lty=12</code>.</p>
</td></tr>
<tr valign="top"><td><code>med.col</code></td>
<td>
<p>The colour of the median age-depth model: not drawn by default <code>med.col=NA</code>.</p>
</td></tr>
<tr valign="top"><td><code>med.lty</code></td>
<td>
<p>The line type of the median age-depth model. Default <code>med.lty=12</code>.</p>
</td></tr>
<tr valign="top"><td><code>C14.col</code></td>
<td>
<p>The colour of the calibrated ranges of the dates. Default is semi-transparent blue: <code>C14.col=rgb(0,0,1,.35)</code>.</p>
</td></tr>
<tr valign="top"><td><code>C14.border</code></td>
<td>
<p>The colours of the borders of calibrated 14C dates. Default is semi-transparent dark blue: <code>C14.border=rgb(0, 0, 1, 0.5)</code>.</p>
</td></tr>
<tr valign="top"><td><code>cal.col</code></td>
<td>
<p>The colour of the non-14C dates. Default is semi-transparent blue-green: <code>cal.col=rgb(0,.5,.5,.35)</code>.</p>
</td></tr>
<tr valign="top"><td><code>cal.border</code></td>
<td>
<p>The colour of the border of non-14C dates in the age-depth plot: default semi-transparent dark blue-green: <code>cal.border=rgb(0,.5,.5,.5)</code>. Not used by default.</p>
</td></tr>
<tr valign="top"><td><code>dates.col</code></td>
<td>
<p>As an alternative to colouring dates based on whether they are 14C or not, sets of dates can be coloured as, e.g., <code>dates.col=colours()[2:100]</code>.</p>
</td></tr>
<tr valign="top"><td><code>pb.background</code></td>
<td>
<p>Probability at which total Pb values are considered to have reached background values, or in other words, that their modelled values are at or below supported + detection limit (Al)). Setting this at .5 means that any depth with a Pb measurement, where at least half of the iterations model Pb values reaching background values, is flagged as having reached background. The age-model is not extended to any Pb measurements that have reached background.</p>
</td></tr>
<tr valign="top"><td><code>pbmodelled.col</code></td>
<td>
<p>Colour of the modelled 210Pb values. Defaults to shades of blue: <code>pbmodelled.col=function(x) rgb(0,0,1,x)</code>.</p>
</td></tr>
<tr valign="top"><td><code>pbmeasured.col</code></td>
<td>
<p>Colour of the measured 210Pb values (default <code>pbmeasured.col="blue"</code>). Draws rectangles of the upper and lower depths as well as the Pb values with 95 percent error ranges.</p>
</td></tr>
<tr valign="top"><td><code>pb.lim</code></td>
<td>
<p>Axis limits for the Pb-210 data. Calculated automatically by default (<code>pblim=c()</code>).</p>
</td></tr>
<tr valign="top"><td><code>supp.col</code></td>
<td>
<p>Colour of supported Pb-210. Defaults to purple, because why not.</p>
</td></tr>
<tr valign="top"><td><code>plot.tail</code></td>
<td>
<p>The depth axis can extend to all Pb measurements (<code>plot.tail=TRUE</code>), or leave out the ones where background has been reached.</p>
</td></tr>
<tr valign="top"><td><code>remove.tail</code></td>
<td>
<p>Whether or not to remove the tail measurements when plotting. Sometimes automated removal might go wrong, so then this option can be used to avoid removing the tail measurements. Quite similar to plot.tail.</p>
</td></tr>
<tr valign="top"><td><code>hiatus.col</code></td>
<td>
<p>The colour of the depths of any hiatuses. Default <code>hiatus.col=grey(0.5)</code>.</p>
</td></tr>
<tr valign="top"><td><code>hiatus.lty</code></td>
<td>
<p>The line type of the depths of any hiatuses. Default <code>hiatus.lty=12</code>.</p>
</td></tr>
<tr valign="top"><td><code>rgb.scale</code></td>
<td>
<p>The function to produce a coloured representation of all age-models. Needs 3 values for the intensity of red, green and blue. Defaults to grey-scales: <code>rgb.scale=c(0,0,0)</code>, but could also be, say, scales of red (<code>rgb.scale=c(1,0,0)</code>).</p>
</td></tr>
<tr valign="top"><td><code>rgb.res</code></td>
<td>
<p>Resolution of the colour spectrum depicting the age-depth model. Default <code>rgb.res=100</code>.</p>
</td></tr>
<tr valign="top"><td><code>slump.col</code></td>
<td>
<p>Colour of slumps. Defaults to <code>slump.col=grey(0.8)</code>.</p>
</td></tr>
<tr valign="top"><td><code>normalise.dists</code></td>
<td>
<p>By default, the distributions of more precise dates will cover less time and will thus peak higher than less precise dates. This can be avoided by specifying <code>normalise.dists=FALSE</code>.</p>
</td></tr>
<tr valign="top"><td><code>same.heights</code></td>
<td>
<p>Plot the distributions of the dates all at the same maximum height (default <code>same.height=FALSE</code>).</p>
</td></tr>
<tr valign="top"><td><code>cc</code></td>
<td>
<p>Calibration curve for 14C dates: <code>cc=1</code> for IntCal20 (northern hemisphere terrestrial), <code>cc=2</code> for Marine20 (marine), <code>cc=3</code> for SHCal20 (southern hemisphere terrestrial). For dates that are already on the cal BP scale use <code>cc=0</code>.</p>
</td></tr>
<tr valign="top"><td><code>title</code></td>
<td>
<p>The title of the age-depth model is plotted on the main panel. By default this is the core's name. To leave empty: <code>title=""</code>.</p>
</td></tr>
<tr valign="top"><td><code>title.location</code></td>
<td>
<p>Location of the title. Default <code>title.location='topleft'</code>.</p>
</td></tr>
<tr valign="top"><td><code>title.size</code></td>
<td>
<p>Size of the title font. Defaults to <code>title.size=1.5</code>.</p>
</td></tr>
<tr valign="top"><td><code>after</code></td>
<td>
<p>Sets a short section above and below hiatus.depths within which to calculate ages. For internal calculations - do not change.</p>
</td></tr>
<tr valign="top"><td><code>bty</code></td>
<td>
<p>Type of box to be drawn around plots (<code>"n"</code> for none, and <code>"l"</code> (default), <code>"7"</code>, <code>"c"</code>, <code>"u"</code>, or <code>"o"</code> for correspondingly shaped boxes).</p>
</td></tr>
<tr valign="top"><td><code>mar.left</code></td>
<td>
<p>Plot margins for the topleft panel (amount of white space along edges of axes 1-4). Default <code>mar.left=c(3,3,1,1)</code>.</p>
</td></tr>
<tr valign="top"><td><code>mar.middle</code></td>
<td>
<p>Plot margins for the middle panel(s) at the top (amount of white space along edges of axes 1-4). Default <code>mar.middle=c(3,3,1,1)</code>.</p>
</td></tr>
<tr valign="top"><td><code>mar.right</code></td>
<td>
<p>Plot margins for the topright panel (amount of white space along edges of axes 1-4). Default <code>mar.right=c(3,3,1,1)</code>.</p>
</td></tr>
<tr valign="top"><td><code>mar.main</code></td>
<td>
<p>Plot margins for the main panel (amount of white space along edges of axes 1-4). Default <code>mar.main=c(3,3,1,1)</code>.</p>
</td></tr>
<tr valign="top"><td><code>righthand</code></td>
<td>
<p>Adapt the righthand margins by a certain amount (default 2) to allow a righthand axis to be plotted (for plum)</p>
</td></tr>
<tr valign="top"><td><code>mgp</code></td>
<td>
<p>Axis text margins (where should titles, labels and tick marks be plotted). Defaults to <code>mgp=c(1.7, .7, .0)</code>.</p>
</td></tr>
<tr valign="top"><td><code>xaxs</code></td>
<td>
<p>Extension of x-axis. By default, add some extra white-space at both extremes (<code>xaxs="r"</code>). See ?par for other options.</p>
</td></tr>
<tr valign="top"><td><code>yaxs</code></td>
<td>
<p>Extension of y-axis. By default, add no extra white-space at both extremes (<code>yaxs="i"</code>). See ?par for other options.</p>
</td></tr>
<tr valign="top"><td><code>prior.ticks</code></td>
<td>
<p>Plot tickmarks and values on the vertical axes for the prior and posterior distributions. Defaults to no tick marks (<code>prior.ticks="n"</code>). Set to <code>prior.ticks="s"</code> to plot the tick marks. Note that these values are of little practical use, as they correspond poorly to, e.g., the mean and strength values. All that matters is that the areas of both the prior and the posterior distributions sum to 1; wider distributions tend to give lower peaks, and narrower distributions higher peaks.</p>
</td></tr>
<tr valign="top"><td><code>prior.fontsize</code></td>
<td>
<p>Font size of the prior, relative to R's standard size. Defaults to <code>prior.fontsize=0.9</code>.</p>
</td></tr>
<tr valign="top"><td><code>toppanel.fontsize</code></td>
<td>
<p>Font size of the top panels, relative to R's standard size. Defaults to <code>prior.fontsize=0.9</code>.</p>
</td></tr>
<tr valign="top"><td><code>xaxt</code></td>
<td>
<p>Whether or not to plot the x-axis. Can be used to adapt axes after a plot. See ?par for other options.</p>
</td></tr>
<tr valign="top"><td><code>yaxt</code></td>
<td>
<p>Whether or not to plot the y-axis. Can be used to adapt axes after a plot. See ?par for other options.</p>
</td></tr>
<tr valign="top"><td><code>plot.pb</code></td>
<td>
<p>Plot the 210Pb data (if present). Defaults to <code>plot.pb=TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>pb.lty</code></td>
<td>
<p>Line type of measured Pb-210 data.</p>
</td></tr>
<tr valign="top"><td><code>plot.pdf</code></td>
<td>
<p>Produce a pdf file of the age-depth plot.</p>
</td></tr>
<tr valign="top"><td><code>dates.only</code></td>
<td>
<p>By default, the age-depth model is plotted on top of the dates. This can be avoided by supplying <code>dates.only=TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>model.only</code></td>
<td>
<p>By default, panels showing the MCMC iterations and the priors and posteriors for accumulation rate and memory are plotted above the main age-depth model panel. This can be avoided by supplying <code>model.only=TRUE</code>. Note however that this removes relevant information to evaluate the age-depth model, so we do recommend to present age-models together with these upper panels.</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>Provide a summary of the age ranges after producing the age-depth model graph; default <code>verbose=FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After loading a previous run, or after running either the <a href="scissors.html">scissors</a> or <a href="thinner.html">thinner</a> command, plot the age-model
again using the command <code>agedepth()</code>.
</p>


<h3>Value</h3>

<p>A plot of the age-depth model, and estimated ages incl. confidence ranges for each depth.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre>


  Bacon(ask=FALSE, coredir=tempfile())
  agedepth()

</pre>

<hr /><div style="text-align: center;">[Package <em>rbacon</em> version 2.5.5 <a href="00Index.html">Index</a>]</div>
</body></html>
