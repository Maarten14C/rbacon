<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Event probabilities against calendar age</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for AgesOfEvents {rbacon}"><tr><td>AgesOfEvents {rbacon}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Event probabilities against calendar age</h2>

<h3>Description</h3>

<p>Plot probability curves for events in the core, expressed against calendar age.
</p>


<h3>Usage</h3>

<pre>
AgesOfEvents(
  window,
  move,
  set = get("info"),
  plot.steps = FALSE,
  BCAD = set$BCAD,
  age.lab = c(),
  yr.lab = age.lab,
  age.lim = c(),
  yr.lim = age.lim,
  prob.lab = "probability",
  prob.lim = c(),
  rotate.axes = FALSE,
  rev.age = TRUE,
  rev.yr = rev.age,
  yaxs = "i",
  bty = "l"
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>window</code></td>
<td>
<p>Width of the window.</p>
</td></tr>
<tr valign="top"><td><code>move</code></td>
<td>
<p>Step size with which the window moves.</p>
</td></tr>
<tr valign="top"><td><code>set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr valign="top"><td><code>plot.steps</code></td>
<td>
<p>Plot probability values step-wise (defaults to <code>plot.steps=FALSE</code>, which plots smooth curves instead).</p>
</td></tr>
<tr valign="top"><td><code>BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>age.lab</code></td>
<td>
<p>The labels for the calendar axis (default <code>age.lab="cal BP"</code> or <code>"BC/AD"</code> if <code>BCAD=TRUE</code>).</p>
</td></tr>
<tr valign="top"><td><code>yr.lab</code></td>
<td>
<p>Deprecated - use age.lab instead</p>
</td></tr>
<tr valign="top"><td><code>age.lim</code></td>
<td>
<p>Minimum and maximum calendar age ranges, calculated automatically by default (<code>age.lim=c()</code>).</p>
</td></tr>
<tr valign="top"><td><code>yr.lim</code></td>
<td>
<p>Deprecated - use age.lim instead</p>
</td></tr>
<tr valign="top"><td><code>prob.lab</code></td>
<td>
<p>Label of the probability axis (default <code>prob.lab="probability"</code>).</p>
</td></tr>
<tr valign="top"><td><code>prob.lim</code></td>
<td>
<p>Limits of the probability axis (calculated automatically by default).</p>
</td></tr>
<tr valign="top"><td><code>rotate.axes</code></td>
<td>
<p>The default of plotting age on the horizontal axis and event probability on the vertical one can be changed with <code>rotate.axes=TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>rev.age</code></td>
<td>
<p>The direction of the age axis, which can be reversed using <code>rev.age=TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>rev.yr</code></td>
<td>
<p>Deprecated - use rev.age instead</p>
</td></tr>
<tr valign="top"><td><code>yaxs</code></td>
<td>
<p>Extension of the y-axis. Defaults to the exact ranges of the probability values. White space can be added to the vertical axis using <code>yaxs="r"</code>.</p>
</td></tr>
<tr valign="top"><td><code>bty</code></td>
<td>
<p>Type of box to be drawn around plots. Draw a box around the graph (<code>"n"</code> for none, and <code>"l"</code>, <code>"7"</code>,
<code>"c"</code>, <code>"u"</code>, &quot;]&quot; or <code>"o"</code> for correspondingly shaped boxes).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Probabilities of depths with 'events' in an age-modelled core can be plotted against time, taking into account
chronological uncertainties (Blaauw et al. 2007). Such events could be for example core depths at which proxies
indicate changes toward wetter local conditions. This can be expressed as values between 0 (no event) and 1 (event at 100% probability)
for each depth.
</p>
<p>Blaauw et al. 2010 propose to estimate probabilities of events by finding specific proxy features such as increasing curves.
Probabilities are then estimated through resampling from the proxy values, where low to modest rises of proxy curves result
in low event probabilities, and clear proxy rises in high probabilities. A smooth spline can be applied to adapt the balance of short-term vs long-term events. To calculate the event probabilities,
produce a file with two columns (depth and corresponding proxy-derived probabilities, separated by white spaces).
Do not provide headers at the file's first line, and save the file with extension &quot;_events.txt&quot; within the core's Bacon folder. See Cores/MSB2K/MSB2K_events.txt (or Bacon_runs/MSB2K/MSB2K_events.txt) for an example. Events are calculated as the probability that an event took place within specific time windows - or more specifically, that the Bacon age-depth model puts depths with assigned event probabilities in that time window.
</p>
<p>does not yet deal correctly with hiatuses.
</p>


<h3>Value</h3>

<p>The resulting probabilities are plotted and saved within the core's folder (file names ending with the window width and &quot;_probs.txt&quot;).
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>References</h3>

<p>Blaauw, M., Christen, J.A., Mauquoy, D., van der Plicht, J., Bennett, K.D. (2007) Testing the timing of radiocarbon-dated events between proxy archives. _The Holocene_, *17*, 283-288.
Blaauw, M., Wohlfarth, B., Christen, J.A., Ampel, L., Veres, D., Hughen, K.A., Preusser, F., Svensson, A. (2010) Were last glacial climate events simultaneous between Greenland and France? A quantitative comparison using non-tuned chronologies. _Journal of Quaternary Science_ *25*, 387-394.
</p>


<h3>Examples</h3>

<pre>

  Bacon(run=FALSE, coredir=tempfile())
  agedepth(yr.res=50)
  AgesOfEvents(100, 10)

</pre>

<hr /><div style="text-align: center;">[Package <em>rbacon</em> version 2.5.5 <a href="00Index.html">Index</a>]</div>
</body></html>
